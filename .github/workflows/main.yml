name: CI

permissions:
  contents: write

# Only trigger this script when you push to the master branch
on:
  push:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest

    # Download our master branch
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v3
        with:
          node-version: '20.x'

      - run: yarn install
      - run: yarn lint

      - name: Setup git credentials
        env: # use github secrets as env variable
          GIT_NAME: ${{ secrets.GIT_NAME }}
          GIT_EMAIL: ${{ secrets.GIT_EMAIL }}
        run: |
          git config --global user.name "$GIT_NAME"
          git config --global user.email "$GIT_EMAIL"

      # Run our deployment command
      - name: Deploying the static website to gh-pages
        env:
          FILTER_BRANCH_SQUELCH_WARNING: 1
        run: npm run deploy
